<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Generate Favicon Files</title>
</head>
<body>
    <h1>Favicon File Generator</h1>
    <p>Click the button below to generate and download all favicon files automatically:</p>
    <button onclick="generateAllFavicons()">Generate All Favicons</button>
    
    <div id="status"></div>

    <script>
        function generateIconFromSVG(size) {
            return new Promise((resolve, reject) => {
                // Create an SVG element with our icon
                const svgString = `<svg xmlns="http://www.w3.org/2000/svg" height="${size}px" viewBox="0 -960 960 960" width="${size}px">
  <defs>
    <!-- Radial gradient for water drop -->
    <radialGradient id="waterGradient" cx="0.4" cy="0.3" r="0.7">
      <stop offset="0%" stop-color="#4FC3F7"/>
      <stop offset="40%" stop-color="#2196F3"/>
      <stop offset="100%" stop-color="#1565C0"/>
    </radialGradient>
    
    <!-- Gradient for the reflection -->
    <radialGradient id="reflectionGradient" cx="0.5" cy="0.5" r="0.8">
      <stop offset="0%" stop-color="rgba(255,255,255,0.9)"/>
      <stop offset="50%" stop-color="rgba(255,255,255,0.6)"/>
      <stop offset="100%" stop-color="rgba(255,255,255,0.2)"/>
    </radialGradient>
  </defs>
  
  <!-- Main water drop shape with blue gradient -->
  <path d="M480-80q-137 0-228.5-94T160-408q0-100 79.5-217.5T480-880q161 137 240.5 254.5T800-408q0 140-91.5 234T480-80Z" 
        fill="url(#waterGradient)"/>
  
  <!-- Bottom right reflection (original Material Design reflection) with white gradient -->
  <path d="M491-200q12-1 20.5-9.5T520-230q0-14-9-22.5t-23-7.5q-41 3-87-22.5T343-375q-2-11-10.5-18t-19.5-7q-14 0-23 10.5t-6 24.5q17 91 80 130t127 35Z" 
        fill="url(#reflectionGradient)"/>
</svg>`;
                
                // Create an image element from the SVG
                const img = new Image();
                const svgBlob = new Blob([svgString], {type: 'image/svg+xml'});
                const url = URL.createObjectURL(svgBlob);
                
                img.onload = function() {
                    // Create canvas and draw the SVG
                    const canvas = document.createElement('canvas');
                    canvas.width = size;
                    canvas.height = size;
                    const ctx = canvas.getContext('2d');
                    
                    // Clear canvas with transparent background
                    ctx.clearRect(0, 0, size, size);
                    
                    // Draw the SVG image scaled to the canvas size
                    ctx.drawImage(img, 0, 0, size, size);
                    
                    // Clean up
                    URL.revokeObjectURL(url);
                    
                    // Return the canvas as PNG data URL
                    resolve(canvas.toDataURL('image/png'));
                };
                
                img.onerror = function() {
                    URL.revokeObjectURL(url);
                    reject(new Error('Failed to render SVG'));
                };
                
                img.src = url;
            });
        }
        
        function downloadFile(dataUrl, filename) {
            const link = document.createElement('a');
            link.download = filename;
            link.href = dataUrl;
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
        }
        
        function generateAllFavicons() {
            const status = document.getElementById('status');
            status.innerHTML = '<p>Loading icon.svg and generating favicons...</p>';
            
            const favicons = [
                { size: 16, filename: 'favicon-16x16.png' },
                { size: 32, filename: 'favicon-32x32.png' },
                { size: 180, filename: 'apple-touch-icon.png' },
                { size: 192, filename: 'android-chrome-192x192.png' },
                { size: 512, filename: 'android-chrome-512x512.png' },
                { size: 150, filename: 'mstile-150x150.png' }
            ];
            
            let generated = 0;
            
            // Generate each favicon with a small delay between downloads
            const generateNext = (index) => {
                if (index >= favicons.length) {
                    status.innerHTML += '<p><strong>✅ All favicons generated! Save them to src/web/assets/images/</strong></p>';
                    return;
                }
                
                const favicon = favicons[index];
                
                generateIconFromSVG(favicon.size)
                    .then(dataUrl => {
                        downloadFile(dataUrl, favicon.filename);
                        generated++;
                        status.innerHTML += `<p>✅ Generated ${favicon.filename}</p>`;
                        
                        // Generate next favicon after a short delay
                        setTimeout(() => generateNext(index + 1), 500);
                    })
                    .catch(error => {
                        status.innerHTML += `<p>❌ Error generating ${favicon.filename}: ${error.message}</p>`;
                        // Continue with next favicon even if one fails
                        setTimeout(() => generateNext(index + 1), 500);
                    });
            };
            
            // Start generating
            generateNext(0);
        }
    </script>
</body>
</html>
